<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0" />
		<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
		<title>会员中心 - 我的地址</title>
		<script charset="utf-8" src="../Style/js/ecmall.js" type="text/javascript"></script>
		<script charset="utf-8" src="../Style/js/touchslider.dev.js"></script>
		<script charset="utf-8" type="text/javascript" src="../Style/js/dialog.js" id="dialog_js"></script>
		<script charset="utf-8" type="text/javascript" src="../Style/js/jquery.ui.js" ></script>
		<script charset="utf-8" type="text/javascript" src="../Style/js/jquery.js" ></script>
		<script charset="utf-8" type="text/javascript" src="../Style/js/jquery.validate.js" ></script>
		<script charset="utf-8" type="text/javascript" src="../Style/js/mlselection.js" ></script>
		<script type="text/javascript" src="../Style/js/jquery.citys.js"></script>
		<link href="../Style/css/amazeui.css" rel="stylesheet" type="text/css" />
		<link href="../Style/css/css.css" rel="stylesheet" type="text/css" />
		<link rel="stylesheet" type="text/css" href="../Style/css/animate.min.css"/>
		<style>
			* {
				border: none;outline: none;font-family: "微软雅黑";
			}
			div{
				overflow: hidden;text-overflow: ellipsis;white-space: nowrap;
			}
			/*头部*/
			.topnav {
				width: 100%;height: 50px;line-height: 50px;color: white;font-size: 18px;text-align: center;position: fixed;top: 0;background-color: rgb(240, 93, 0);
			}
			.topnav img{
				position: absolute; left:5px; top: 14px;
			}
			/*收货人S、身份证S*/
			#user{
				width: 95%;height: 40px;margin: 0 auto;margin-top: 55px;
			}
			#user,#phone,#province,#county{
				background-color: white;
			}
			#id-card,#phone,#province,#city,#county,#address{
				width: 95%;height: 40px;margin: 0 auto;margin-top: 5px;background:#fff;
			}
			#user span,#id-card span,#phone span,#province span,#city span,#county span,#address span{
				color: #555;font-size:15px;line-height: 40px;padding-left: 3px;
			}
			#user input,#id-card input,#phone input, #address input{
				width: 70%;color: #555;font-size: 13px;margin-top: -5px;padding-right:25px;
			}
			#id-card input,#address input{
				background-color: rgb(236,234,234);
			}
			/*身份证S*/
			
			.pro,.city,.qu,.jiedao{
				background-color: white;margin-top: 5px;
			}
			
			/*美化下拉选择框S*/
			.pro select,.city select,.qu select,.jiedao select{   /*省份 、城市、区县下拉框*/
				width: 60%;font-size: 13px;background-color: none;-webkit-appearance:none; border:none; appearance:none;font-size: 13px;color: #333333;padding-left: 13px;background-color: #ffffff; 
			}
			.pro span{
				padding-left: 20px;
			}
			#place{
				width: 95%;font-size: 13px;background-color: none;-webkit-appearance:none; border:none; appearance:none;font-size: 13px;color: #333333;background-color: #ffffff; margin:0px auto;
			}
			#place span{
				color: #555;font-size:15px;line-height: 40px;padding-left: 3px;
			}
			/*美化下拉选择框E*/
			
			/*法律条例*/
			#low,#low2{
				width: 90%; height: 100px; overflow: auto; margin: 0 auto;margin-top: 5px;color:#555;line-height:25px;
			}
			#low span,#low2 span{       /*法律条例字体*/
				font-size: 14px;
			}
			/*上传身份证S*/
			#upload-id{
				height: 100px;
			}
			#upload-id .face,#upload-id .con{
				width: 50%; height: 100px; float: left; border: solid 1px rgb(186,185,185); border-left:none ; text-align: center; line-height: 100px; font-size: 13px;
			}
			/*上传身份证E*/
			
			/*保存收货地址*/
			#save{
				width: 100%; height: 50px; color: rgb(240,93,0); background-color: white; text-align: center; line-height: 50px; font-size: 15px; margin-bottom: 70px;
			}
			#upload-pic:first-child{
				border-right: 1px solid #dcdcdc;
			}
			#upload-pic{
  			  position: relative;  width:50%; height:100px; float:left;  top:10px;
	        }
	        #upload-pic img{
	        	height:98px; margin:0 auto;
	        }
	        #upload-pic input
	        {
	            opacity:0;filter:alpha(opacity=0); height: 100%; width: 100%; position: absolute; top: 0;left: 0; z-index: 9;
	           
	        }
	        /*验证消息弹出框*/
			.showinfo {
	        	position: fixed;left: 50%;bottom: 180px;z-index: 99999;border-radius: 5px;background: #000;opacity: 0.9;filter: alpha(opacity=90);
	        	padding: 0 5px;height: 38px;box-shadow: 0px 0px 10px #000;color: #FFFFFF;text-align: center;line-height: 38px;font-size: 14px;display: none;
	        }
		</style>	
	</head>

	<body onLoad="setup()">
		<!--头部-->
		<div class="topnav">
			<a href="{:U('User/address')}" class="back">
				<img src="../Style/images/fanhui1.png" width="25"  />
			</a>
			地址管理
		</div>
		
		<form method="post" action="{:U('User/addaddress')}" id="address_form" name="address_form" enctype="multipart/form-data">
		<input type="hidden" name="ids" value="<?php echo $_GET['ids']; ?>" />
		<input type="hidden" name="is_redirect" value="<?php echo $_GET['is_redirect']; ?>" />
		<!--收货人-->
		<div id="user">
			<span>收货人：</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="text" name="consignee" id="" value="" placeholder="请输入收货人真实姓名" />
		</div>
		<!--身份证-->
		<div id="id-card" style="display:none;">
			<span>身份证：</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="text" name="cardId" id="" value="" placeholder="请输入收货人的身份证号码" style="height:35px;line-height:35px;background:#fff;" />
		</div>
		<!--联系电话-->
		<div id="phone">
			<span>联系电话：</span>&nbsp;&nbsp;&nbsp;<input type="text" name="phone_mob" id="" value="" placeholder="请输入收货人的联系电话" />
		</div>
		<!--法律条例-->
		
		<!--选择省区-->
		<div id="place" style="background-color: rgb(236,234,234);">
			<div id="citys" class="citys">
				<div class="pro">
					<span>选择省份：</span>
					<select id="sheng" name="province" ></select>
					<input type="hidden" id="province" name="sheng"/>
					<i class="am-icon-chevron-down" style="color:rgb(109,109,109);"></i>
				</div>
				
				<div class="city">
					<span>选择城市：</span>
					<select id="shi" name="city"></select>
					<input type="hidden" id="city" name="shi" />
					<i class="am-icon-chevron-down" style="color:rgb(109,109,109);"></i>
				</div>
				
				<div class="qu">
					<span>选择区县：</span>
					<select id="xian" name="area"></select>
					<input type="hidden" id="area" name="qu"/>
					<i class="am-icon-chevron-down" style="color:rgb(109,109,109);"></i>
				</div>
				
				<div class="jiedao">
					<span>选择街道：</span>
					<select id="jie" name="town"></select>
					<input type="hidden" id="town" name="towns"/>
					<i class="am-icon-chevron-down" style="color:rgb(109,109,109);"></i>
				</div>
				
			</div>
			
			<script>
					var $town = $('#citys select[name="town"]');
					var townFormat = function(info){
						$town.hide().empty();
						if(info['code']%1e4&&info['code']<7e5){
							$.ajax({
								url:'http://passer-by.com/data_location/town/'+info['code']+'.json',
								dataType:'json',
								async:false,              //jquery等待ajax执行完毕再继续，默认是true,false表示同步,true表示异步
								success:function(town){
									$town.show();
									for(i in town){ 
											$town.append('<option value="'+town[i]+'">'+town[i]+'</option>');
									}
								}
							});
						}
					};
					$('#citys').citys({
							province:'广东省',
							city:'广州市',
							area:'荔湾区',
							onChange:function(info){
								townFormat(info);
								$("#province").val(info['province']);
								$("#city").val(info['city']);
								$("#area").val(info['area']);
								
							}
						},function(api){
							var info = api.getInfo();
							townFormat(info);
							$("#province").val($("#sheng option").eq(18).text());           //默认选项
							$("#city").val($("#shi option").eq(0).text());
							$("#area").val($("#xian option").eq(0).text());
							$("#town").val($("#jie option").eq(0).text());
					});
			</script>
			
			<!--当改变option值的时候触发-->
			<script type="text/javascript">
				$(function(){
					$(".citys,.pro,.qu,.jiedao").on("change click",function(){
						$("#town").val($("#jie").val());
					});
				});	
			</script>
			
		</div>
		<!--收货地址-->
		<div id="address">
			<span>收货地址：</span>&nbsp;&nbsp;&nbsp;<input type="text" name="address" id="" value="" placeholder="请输入详细地址" style="height:35px;line-height:35px;background:#fff;"  />
		</div>
		
		<!--保存收货地址-->
		<div id="save" style="margin-top: 10px;">
			<a id="check"><p><span style="color:#f05d00;">保存收货地址</p></span></a>
		</div>
		</form>
		<div class="showinfo animated shake"></div>
		<include file="public:footer"/>
		<script type="text/javascript">
			$(function(){
				$("#check").click(function(){
					var consignee = $("input[name='consignee']").val();
					var address = $("input[name='address']").val();
					var phone_mob = $("input[name='phone_mob']").val();
					
					if(consignee==''){
						var content = $('.showinfo').html('请填写收货人姓名');
						var w = content.width()/2;
						$(".showinfo").css("margin-left",-w);
						$(".showinfo").show().delay(3000).fadeOut();
						return false;  
					 }

					if(phone_mob==''){
						var content = $('.showinfo').html('请填收货人手机号码');
						var w = content.width()/2;
						$(".showinfo").css("margin-left",-w);
						$(".showinfo").show().delay(3000).fadeOut();
						return false;  
					}
					
					var phone = /^1([38]\d|4[57]|5[0-35-9]|7[06-8]|8[89])\d{8}$/;
					if(!phone.test(phone_mob)){
						var content = $('.showinfo').html('收货人手机号码无效');
						var w = content.width()/2;
						$(".showinfo").css("margin-left",-w);
						$(".showinfo").show().delay(3000).fadeOut();
						return false;
					}

					 if(address==''){
						var content = $('.showinfo').html('请收货人填写详细地址');
						var w = content.width()/2;
						$(".showinfo").css("margin-left",-w);
						$(".showinfo").show().delay(3000).fadeOut();
						return false;
					 }
					$("#address_form").submit(); 
				});
			});
		</script>
	</body>

</html>